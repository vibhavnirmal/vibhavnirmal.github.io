<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Vibhav Nirmal, vibhav, nirmal, LDCE, MachineLearningBlog, TechieViN">
    <link rel="shortcut icon" type="image" href="resources\images\logos\vin.png" />
    <meta name="description" content="Robotics enthusiast. Learning new stuff every day.">
    <title>Vibhav Nirmal</title>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,300" rel="stylesheet" type="text/css">

    <link rel="stylesheet" href="resources/css/index.css">
    <link rel="stylesheet" href="resources/css/blog.css">
</head>

<body>
    <div id="navBar">
        <div id="stickLeft">
            <a href="index.html" class="navButton">Vibhav Nirmal</a>
            <a href="aboutme.html" class="navButton">About Me</a>
        </div>

        <div id="stickRight">
            <a href="https://github.com/vibhavnirmal" target="_blank">
                <img src="resources/images/logos/GitHub_Logo.png" alt="Github" class="socialIcon" height="36">
            </a>
        </div>
    </div>

    <div class="container">

        <div class="content">
            <div class="mainProjects">
                <div class="filtersAndView">
                    <div class="view-type">
                        <div class="view-type-button" onclick="changeView('list')">
                            <img id="list-icon" src="resources\images\list.svg" alt="List View" class="view-type-icon">
                        </div>
                        <div class="view-type-button" onclick="changeView('grid')">
                            <img id="grid-icon" src="resources\images\grid.svg" alt="Grid View" class="view-type-icon active">
                        </div>
                    </div>
                </div>
                <div id="blog-container" class="grid-view">
                </div>

            </div>
        </div>

        <script>
            function activateFilters() {
                const dropdownButton = document.getElementById('dropdown-button');
                const dropdownContent = document.querySelector('.dropdown-content');
                const filterInput = document.getElementById('filter-input');
                const optionsList = document.getElementById('options-list');
                const selectedOptions = document.getElementById('selected-options');
                // const filterButton = document.getElementById('filter-button');

                // Toggle the dropdown when the button is clicked
                dropdownButton.addEventListener('click', function () {
                    dropdownContent.style.display = dropdownContent.style.display === 'block' ? 'none' : 'block';
                });

                // Filter options as the user types
                filterInput.addEventListener('input', function () {
                    const filterText = filterInput.value.toLowerCase();

                    for (const checkbox of optionsList.querySelectorAll('.option-checkbox')) {
                        const label = checkbox.parentNode;
                        if (label.textContent.toLowerCase().includes(filterText)) {
                            label.style.display = 'block';
                        } else {
                            label.style.display = 'none';
                        }
                    }
                });

                // Apply the filter and close the dropdown
                // filterButton.addEventListener('click', function () {
                //     dropdownContent.style.display = 'none';
                // });

                // Update selected options when checkboxes are clicked
                optionsList.addEventListener('change', function () {
                    const selected = Array.from(optionsList.querySelectorAll('.option-checkbox:checked')).map(checkbox => checkbox.value.toLowerCase());
                    selectedOptions.textContent = selected.length > 0 ? selected.join(', ') : 'None';
                    selectedOptions.classList.toggle('noTag', selected.length === 0);

                    if (selected.length === 0) {
                        filterSelection('all');
                    }else{
                        filterSelection(selected);
                    }
                });
            };

            const changeView = (view) => {
                const container = document.getElementById("blog-container");
                const gridIcon = document.getElementById("grid-icon");
                const listIcon = document.getElementById("list-icon");

                const isGridView = view === 'grid';
                container.classList.toggle("list-view", !isGridView);
                container.classList.toggle("grid-view", isGridView);

                gridIcon.classList.toggle("active", isGridView);
                listIcon.classList.toggle("active", !isGridView);
            };

            // if clicked outside of dropdown, close it
            window.onclick = function (event) {
                if (!event.target.matches('.dropdown-button') && !event.target.matches('.option-checkbox') && !event.target.matches('#filter-input') && !event.target.matches('#options-list') && !event.target.matches('#selected-options') && !event.target.matches('#filter-button') && !event.target.matches('.option-label')) {
                    const dropdowns = document.getElementsByClassName("dropdown-content");
                    for (let i = 0; i < dropdowns.length; i++) {
                        const openDropdown = dropdowns[i];
                        if (openDropdown.style.display === "block") {
                            openDropdown.style.display = "none";
                        }
                    }
                }
                // else{
                //     console.log(event.target);
                // }
            };

            document.addEventListener('DOMContentLoaded', function () {
                // Get the current URL or page
                let currentPage = window.location.href;

                // Find the navigation item that matches the current URL and add the "current" class
                let navigationItems = document.getElementsByTagName('a');
                for (let i = 0; i < navigationItems.length; i++) {
                    if (currentPage.indexOf(navigationItems[i].href) > -1) {
                        navigationItems[i].className = 'current';
                    }
                }
            });

            function createFilterElement(uniqueTags) {
                // Create the main filter container
                const filterElement = document.createElement('div');
                filterElement.classList.add('filters');

                // Create the dropdown container
                const dropdownElement = document.createElement('div');
                dropdownElement.classList.add('dropdown');

                // Create the dropdown button
                const dropdownButtonElement = document.createElement('button');
                dropdownButtonElement.classList.add('dropdown-button');
                dropdownButtonElement.id = 'dropdown-button';
                dropdownButtonElement.textContent = 'Filter Tags';

                // Create the dropdown content container
                const dropdownContentElement = document.createElement('div');
                dropdownContentElement.classList.add('dropdown-content');

                // Create the filter input field
                const filterInputElement = document.createElement('input');
                filterInputElement.type = 'text';
                filterInputElement.id = 'filter-input';
                filterInputElement.placeholder = 'Filter options';

                // Create the options list (ul)
                const optionsListElement = document.createElement('ul');
                optionsListElement.id = 'options-list';

                // Create the option checkboxes and labels
                uniqueTags.forEach(tag => {
                    const optionLiElement = document.createElement('li');

                    const optionLabelElement = document.createElement('label');
                    optionLabelElement.classList.add('option-label');

                    const optionInputElement = document.createElement('input');
                    optionInputElement.type = 'checkbox';
                    optionInputElement.classList.add('option-checkbox');
                    // convert to First Letter Capital
                    tag = tag.charAt(0).toUpperCase() + tag.slice(1);
                    optionInputElement.value = tag;

                    const optionTextElement = document.createTextNode(tag);

                    optionLabelElement.appendChild(optionInputElement);
                    optionLabelElement.appendChild(optionTextElement);

                    optionLiElement.appendChild(optionLabelElement);

                    optionsListElement.appendChild(optionLiElement);
                });

                const filtersSelectedText = document.createElement('p');
                filtersSelectedText.id = 'filters-selected-text';
                filtersSelectedText.textContent = 'Tags selected:';
                filtersSelectedText.style.display = 'inline-block';

                // Create the selected options container
                const selectedOptionsElement = document.createElement('p');
                selectedOptionsElement.id = 'selected-options';
                selectedOptionsElement.classList.add('noTag');
                selectedOptionsElement.textContent = 'None';

                // Create the filter button
                // const filterButtonElement = document.createElement('button');
                // filterButtonElement.id = 'filter-button';
                // filterButtonElement.textContent = 'Apply Filter';
                
                // Add the elements to the DOM
                dropdownContentElement.appendChild(filterInputElement);
                dropdownContentElement.appendChild(optionsListElement);

                dropdownElement.appendChild(dropdownButtonElement);
                dropdownElement.appendChild(dropdownContentElement);

                filterElement.appendChild(dropdownElement);
                filterElement.appendChild(filtersSelectedText);
                filterElement.appendChild(selectedOptionsElement);
                // filterElement.appendChild(filterButtonElement);

                const mainProjectsElement = document.getElementsByClassName('filtersAndView')[0];
                // append at the top
                mainProjectsElement.insertBefore(filterElement, mainProjectsElement.childNodes[0]);

                activateFilters();
            }

            function createBlogListing(project) {
                const blogListing = document.createElement('div');
                blogListing.classList.add('blog-listing');
                blogListing.classList.add('all');

                project.tags.forEach(tag => {
                    blogListing.classList.add(tag);
                });

                // create a div for image and title
                const imageTitleDiv = document.createElement('div');
                imageTitleDiv.classList.add('image-title-div');

                const contentDiv = document.createElement('div');
                contentDiv.classList.add('content-div');


                const titleElement = document.createElement('h2');
                titleElement.classList.add('blog-title');
                titleElement.textContent = project.title;

                const linkElement = document.createElement('a');
                if (project.titleLink === '#') {
                    linkElement.onclick = function () { return false; };
                    linkElement.style.cursor = 'default';
                } else {
                    linkElement.href = project.titleLink;
                }

                // add video element
                if (project.image !== '') {                   
                    if (project.image.includes('mp4')) {
                        const videoElement = document.createElement('video');
                        videoElement.src = project.image;
                        
                        videoElement.autoplay = true;
                        videoElement.loop = true;
                        videoElement.muted = true;

                        videoElement.classList.add('blog-image');
                        imageTitleDiv.appendChild(videoElement);
                    } else {
                        const imageElement = document.createElement('img');
                        imageElement.src = project.image;
                        imageElement.alt = 'Blog Image';
                        imageElement.classList.add('blog-image');
                        imageTitleDiv.appendChild(imageElement);
                    }
                }

                const excerptElement = document.createElement('p');
                excerptElement.classList.add('blog-excerpt');
                excerptElement.textContent = project.description;

                const dateElement = createBlogDateElement(project.date);

                const iconElement = createIconElement(project.multipleLinks);

                if (project.image !== '') {
                    blogListing.appendChild(imageTitleDiv);
                    contentDiv.appendChild(dateElement);
                    linkElement.appendChild(titleElement);
                    contentDiv.appendChild(linkElement);
                    contentDiv.appendChild(excerptElement);
                    contentDiv.appendChild(iconElement);
                    blogListing.appendChild(contentDiv);
                } else {
                    blogListing.appendChild(dateElement);
                    linkElement.appendChild(titleElement);
                    blogListing.appendChild(linkElement);
                    blogListing.appendChild(excerptElement);
                    blogListing.appendChild(iconElement);
                }

                return blogListing;
            }

            function createBlogDateElement(date) {
                const dateElement = document.createElement('p');
                dateElement.classList.add('blog-date');

                const dateObject = new Date(date);
                dateObject.setDate(dateObject.getDate() + 1);
                const humanDateFormat = dateObject.toLocaleString("en-US", { weekday: "long", year: "numeric", month: "long", day: "numeric" });
                dateElement.textContent = 'Published on ' + humanDateFormat;

                return dateElement;
            }

            function createIconElement(multipleLinks) {
                const iconElement = document.createElement('div');
                iconElement.classList.add('blog-icons');

                multipleLinks.forEach(link => {
                    if (link.link === '#') {
                        iconElement.style.display = 'none';
                    } else {
                        const iconLink = document.createElement('a');
                        iconLink.href = link.link;

                        const iconImg = document.createElement('img');
                        iconImg.src = link.icon;
                        iconImg.alt = 'Icon';
                        iconImg.classList.add('socialIcon');

                        iconLink.appendChild(iconImg);
                        iconElement.appendChild(iconLink);
                    }
                });

                return iconElement;
            }

            function filterSelection(tags) {
                const blogListings = document.getElementsByClassName('blog-listing');

                for (const blogList of blogListings) {
                    const blogListClasses = blogList.classList;

                    if (tags === 'all' || tags.some(tag => blogListClasses.contains(tag))) {
                        blogList.style.display = 'block';
                    } else {
                        blogList.style.display = 'none';
                    }
                }
            }

            fetch('resources/data.json')
                .then(response => response.json())
                .then(data => {
                    let alltags = [];

                    data.projects.forEach(project => {
                        project.tags.forEach(tag => {
                            alltags.push(tag);
                        });
                    });

                    const uniqueTags = Array.from(new Set(alltags));

                    createFilterElement(uniqueTags);

                    const blogContainer = document.getElementById('blog-container');

                    data.projects.forEach(project => {
                        const blogListing = createBlogListing(project);
                        blogContainer.appendChild(blogListing);
                    });
                })
                .catch(error => console.error(error));

        </script>
</body>

</html>